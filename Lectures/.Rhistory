library(datasets)
install.packages("AER")
library(AER)
head(ShipAccidents)
head(ShipAccidents)
ShipAccidents
data("ShipAccidents")
plot(data=ShipAccidents)
library(mosaic)
?ShipAccidents
data("TeachingEvaluations") #Puts dataset from book into Environment
library(AER) #Package for Applied Econometrics with R
library(mosaic)
data("TeachingEvaluations") #Puts dataset from book into Environment
data("TeachingRatings") #Puts dataset from book into Environment
?TeachingRatings
plot(eval~age,data=TeachingRatings)
plot(eval~beauty,data=TeachingRatings)
plot(beauty~age,data=TeachingRatings)
library(stat2Data) #Package for Textbook
library(mosaic)
data("AccordPrice") #Puts dataset into Global Environment
library(stat2Data) #Package for Textbook
library(mosaic)
data("AccordPrice") #Puts dataset into Global Environment
data("AccordPrice") #Puts dataset into Global Environment
stat2Data::AccordPrice
library(stat2Data) #Package for Textbook
install.packages("Stat2Data")
library(Stat2Data) #Package for Textbook
library(mosaic)
data("AccordPrice") #Puts dataset into Global Environment
plot(beauty~age,data=TeachingRatings)
library(Stat2Data) #Package for Textbook
library(mosaic)
data("AccordPrice") #Puts dataset into Global Environment
plot(Price~Age,data=TeachingRatings)
plot(Price~Age,data=TeachingRatings)
plot(Price~Age,data=AccordPrice)
plot(Price~Mileage,data=AccordPrice)
plot(Age~Mileage)
plot(Age~Mileage,data=AccordPrice)
plot(Price~Age,data=AccordPrice)
library(Stat2Data) #Package for Textbook
library(mosaic)
data("AccordPrice") #Puts dataset into Global Environment
plot(Price~Age,data=AccordPrice)
20.81-0.1198*50
library(AER) #Package for Textbook
data("BankWages") #Puts dataset into Global Environment
View(BankWages)
data("CASchools") #Puts dataset into Global Environment
View(CASchools)
View(CASchools)
?CASchools
plot(expenditure~computer,data=AccordPrice)
plot(expenditure~computer,data=CASchools)
model=lm(expenditure~computer, data=CASchools)
mod1=lm(expenditure~computer, data=CASchools)
plot(expenditure~computer,data=CASchools)
abline(mod1)
lm(expenditure~computer, data=CASchools)
summary(mod1)
?CASchools
mod1=lm(expenditure~income, data=CASchools)
plot(expenditure~income,data=CASchools)
abline(mod1)
summary(mod1)
library(Stat2Data)
data("PalmBeach")
View(PalmBeach)
?sort
View(PalmBeach)
sort(PalmBeach$Buchanan)
knitr::opts_chunk$set(echo = TRUE)
library(mosaic)
plot(Buchanan~Bush,data= PalmBeach)
library(Stat2Data)
library(mosaic)
data("PalmBeach")
plot(Buchanan~Bush,data= PalmBeach)
library(Stat2Data)
library(mosaic)
data("PalmBeach")
plot(Buchanan~Bush,data= PalmBeach)
abline(v=mean(PalmBeach$Buchanan),col="red",lty=2)
mean(PalmBeach$Buchanan)
plot(Buchanan~Bush,data= PalmBeach)
abline(v=mean(PalmBeach$Buchanan),col="red",lty=2)
plot(Buchanan~Bush,data= PalmBeach)
abline(v=mean(PalmBeach$Bush),col="red",lty=2)
library(Stat2Data)
library(mosaic)
data("PalmBeach")
plot(Buchanan~Bush,data= PalmBeach,cex=2)
abline(v=mean(PalmBeach$Bush),col="red",lty=2)
library(Stat2Data)
library(mosaic)
data("PalmBeach")
plot(Buchanan~Bush,data= PalmBeach,cex=2,pch=16)
abline(v=mean(PalmBeach$Bush),col="red",lty=2)
library(Stat2Data)
library(mosaic)
data("PalmBeach")
plot(Buchanan~Bush,data= PalmBeach,pch=16)
abline(v=mean(PalmBeach$Bush),col="red",lty=2)
library(Stat2Data)
library(mosaic)
data("PalmBeach")
plot(Buchanan~Bush,data= PalmBeach,pch=16)
abline(v=mean(PalmBeach$Bush),col="red",lty=2,lwd=2)
mean(PalmBeach$Bush)
library(Stat2Data)
library(mosaic)
data("PalmBeach")
plot(Buchanan~Bush,data= PalmBeach,pch=16)
abline(v=mean(PalmBeach$Bush),col="red",lty=2,lwd=2)
View(PalmBeach)
View(PalmBeach)
point(x=PalmBeach$Bush[which(PalmBeach$Count=="PalmBeach")])
library(Stat2Data)
library(mosaic)
data("PalmBeach")
plot(Buchanan~Bush,data= PalmBeach,pch=16)
abline(v=mean(PalmBeach$Bush),col="red",lty=2,lwd=2)
points(x=PalmBeach$Bush[which(PalmBeach$Count=="PalmBeach")],
y=PalmBeach$Buchanan[which(PalmBeach$Count=="PalmBeach")])
plot(Buchanan~Bush,data= PalmBeach,pch=16)
abline(v=mean(PalmBeach$Bush),col="red",lty=2,lwd=2)
points(x=PalmBeach$Bush[which(PalmBeach$Count=="PalmBeach")],
y=PalmBeach$Buchanan[which(PalmBeach$Count=="PalmBeach")],col="green")
PalmBeach$Bush[which(PalmBeach$Count=="PalmBeach")]
library(Stat2Data)
library(mosaic)
data("PalmBeach")
plot(Buchanan~Bush,data= PalmBeach,pch=16)
abline(v=mean(PalmBeach$Bush),col="red",lty=2,lwd=2)
points(x=PalmBeach$Bush[which(PalmBeach$County=="PalmBeach")],
y=PalmBeach$Buchanan[which(PalmBeach$County=="PalmBeach")],col="green")
PalmBeach$Bush[which(PalmBeach$County=="PalmBeach")]
[which(PalmBeach$County=="PalmBeach")
which(PalmBeach$County=="PalmBeach")
library(Stat2Data)
library(mosaic)
data("PalmBeach")
plot(Buchanan~Bush,data= PalmBeach,pch=16)
abline(v=mean(PalmBeach$Bush),col="red",lty=2,lwd=2)
points(x=PalmBeach$Bush[which(PalmBeach$County=="Palm Beach")],
y=PalmBeach$Buchanan[which(PalmBeach$County=="Palm Beach")],col="green")
points(x=PalmBeach$Bush[which(PalmBeach$County=="Palm Beach")],
y=PalmBeach$Buchanan[which(PalmBeach$County=="Palm Beach")],col="green")
plot(Buchanan~Bush,data= PalmBeach,pch=16)
abline(v=mean(PalmBeach$Bush),col="red",lty=2,lwd=2)
points(x=PalmBeach$Bush[which(PalmBeach$County=="Palm Beach")],
y=PalmBeach$Buchanan[which(PalmBeach$County=="Palm Beach")],col="green")
PalmBeach$Buchanan[which(PalmBeach$County=="Palm Beach")]
library(Stat2Data)
library(mosaic)
data("PalmBeach")
plot(Buchanan~Bush,data= PalmBeach,pch=16)
abline(v=mean(PalmBeach$Bush),col="red",lty=2,lwd=2)
points(x=PalmBeach$Bush[which(PalmBeach$County=="PALM BEACH")],
y=PalmBeach$Buchanan[which(PalmBeach$County=="PALM BEACH")],col="green")
library(Stat2Data)
library(mosaic)
data("PalmBeach")
plot(Buchanan~Bush,data= PalmBeach,pch=16)
abline(v=mean(PalmBeach$Bush),col="red",lty=2,lwd=2)
points(x=PalmBeach$Bush[which(PalmBeach$County=="PALM BEACH")],
y=PalmBeach$Buchanan[which(PalmBeach$County=="PALM BEACH")],col="green",cex=2)
library(Stat2Data)
library(mosaic)
data("PalmBeach")
plot(Buchanan~Bush,data= PalmBeach,pch=16)
abline(v=mean(PalmBeach$Bush),col="red",lty=2,lwd=2)
points(x=PalmBeach$Bush[which(PalmBeach$County=="PALM BEACH")],
y=PalmBeach$Buchanan[which(PalmBeach$County=="PALM BEACH")],col="green",cex=2,pch=16)
library(Stat2Data)
library(mosaic)
data("PalmBeach")
plot(Buchanan~Bush,data= PalmBeach,pch=16)
abline(v=mean(PalmBeach$Bush),col="red",lty=2,lwd=2)
points(x=PalmBeach$Bush[which(PalmBeach$County=="PALM BEACH")],
y=PalmBeach$Buchanan[which(PalmBeach$County=="PALM BEACH")],col="darkgreen",cex=2,pch=16)
library(Stat2Data)
library(mosaic)
data("PalmBeach")
plot(Buchanan~Bush,data= PalmBeach,pch=16)
abline(v=mean(PalmBeach$Bush),col="red",lty=2,lwd=2)
points(x=PalmBeach$Bush[which(PalmBeach$County=="PALM BEACH")],
y=PalmBeach$Buchanan[which(PalmBeach$County=="PALM BEACH")],col="darkgreen",cex=2,pch=16)
points(x=PalmBeach$Bush[which(PalmBeach$County=="DADE")],
y=PalmBeach$Buchanan[which(PalmBeach$County=="DADE")],col="darkblue",cex=2,pch=16)
library(Stat2Data)
library(mosaic)
data("PalmBeach")
plot(Buchanan~Bush,data= PalmBeach,pch=16)
abline(v=mean(PalmBeach$Bush),col="red",lty=2,lwd=2)
points(x=PalmBeach$Bush[which(PalmBeach$County=="PALM BEACH")],
y=PalmBeach$Buchanan[which(PalmBeach$County=="PALM BEACH")],col="darkgreen",cex=2,pch=16)
points(x=PalmBeach$Bush[which(PalmBeach$County=="DADE")],
y=PalmBeach$Buchanan[which(PalmBeach$County=="DADE")],col="darkred",cex=2,pch=16)
library(Stat2Data)
library(mosaic)
data("PalmBeach")
plot(Buchanan~Bush,data= PalmBeach,pch=16)
abline(v=mean(PalmBeach$Bush),col="red",lty=2,lwd=2)
points(x=PalmBeach$Bush[which(PalmBeach$County=="PALM BEACH")],
y=PalmBeach$Buchanan[which(PalmBeach$County=="PALM BEACH")],col="darkgreen",cex=2,pch=16)
points(x=PalmBeach$Bush[which(PalmBeach$County=="DADE")],
y=PalmBeach$Buchanan[which(PalmBeach$County=="DADE")],col="red",cex=2,pch=16)
library(Stat2Data)
library(mosaic)
data("PalmBeach")
plot(Buchanan~Bush,data= PalmBeach,pch=16)
abline(v=mean(PalmBeach$Bush),col="red",lty=2,lwd=2)
points(x=PalmBeach$Bush[which(PalmBeach$County=="PALM BEACH")],
y=PalmBeach$Buchanan[which(PalmBeach$County=="PALM BEACH")],cex=2,pch=1)
points(x=PalmBeach$Bush[which(PalmBeach$County=="DADE")],
y=PalmBeach$Buchanan[which(PalmBeach$County=="DADE")],cex=2,pch=16)
library(Stat2Data)
library(mosaic)
data("PalmBeach")
plot(Buchanan~Bush,data= PalmBeach,pch=16)
abline(v=mean(PalmBeach$Bush),col="red",lty=2,lwd=2)
points(x=PalmBeach$Bush[which(PalmBeach$County=="PALM BEACH")],
y=PalmBeach$Buchanan[which(PalmBeach$County=="PALM BEACH")],cex=2,pch=2)
points(x=PalmBeach$Bush[which(PalmBeach$County=="DADE")],
y=PalmBeach$Buchanan[which(PalmBeach$County=="DADE")],cex=2,pch=16)
library(Stat2Data)
library(mosaic)
data("PalmBeach")
plot(Buchanan~Bush,data= PalmBeach,pch=16)
abline(v=mean(PalmBeach$Bush),col="red",lty=2,lwd=2)
points(x=PalmBeach$Bush[which(PalmBeach$County=="PALM BEACH")],
y=PalmBeach$Buchanan[which(PalmBeach$County=="PALM BEACH")],cex=2,pch=17)
points(x=PalmBeach$Bush[which(PalmBeach$County=="DADE")],
y=PalmBeach$Buchanan[which(PalmBeach$County=="DADE")],cex=2,pch=17)
library(Stat2Data)
library(mosaic)
data("PalmBeach")
plot(Buchanan~Bush,data= PalmBeach,pch=16)
abline(v=mean(PalmBeach$Bush),col="red",lty=2,lwd=2)
points(x=PalmBeach$Bush[which(PalmBeach$County=="PALM BEACH")],
y=PalmBeach$Buchanan[which(PalmBeach$County=="PALM BEACH")],cex=2,pch=15)
points(x=PalmBeach$Bush[which(PalmBeach$County=="DADE")],
y=PalmBeach$Buchanan[which(PalmBeach$County=="DADE")],cex=2,pch=17)
library(Stat2Data)
library(mosaic)
data("PalmBeach")
plot(Buchanan~Bush,data= PalmBeach,pch=16)
abline(v=mean(PalmBeach$Bush),col="red",lty=2,lwd=2)
points(x=PalmBeach$Bush[which(PalmBeach$County=="PALM BEACH")],
y=PalmBeach$Buchanan[which(PalmBeach$County=="PALM BEACH")],
cex=2,pch=15)
points(x=PalmBeach$Bush[which(PalmBeach$County=="DADE")],
y=PalmBeach$Buchanan[which(PalmBeach$County=="DADE")],
cex=2,pch=17)
avg.x=mean(PalmBeach$Buchanan)
?leverage
avg.x = mean(PalmBeach$Buchanan)
avg.x = mean(PalmBeach$Bush)
nrow(PalmBeach)
avg.x = mean(PalmBeach$Bush)
Leverage = 1/nrow(PalmBeach) + (PalmBeach$Bush - avg.x)^2/sum((PalmBeach$Bush - avg.x)^2)
PalmBeach$Leverage= Leverage
avg.x = mean(PalmBeach$Bush)
Leverage = 1/nrow(PalmBeach) + (PalmBeach$Bush - avg.x)^2/sum((PalmBeach$Bush - avg.x)^2)
PalmBeach$Leverage= Leverage
PalmBeach[sort(PalmBeach$Leverage),]
sort(PalmBeach$Leverage)
sort(PalmBeach$Leverage)
#Calculate Average Number of Votes for Bush
avg.x = mean(PalmBeach$Bush)
devsquared= (PalmBeach$Bush - avg.x)^2
#Calculate Leverage
Leverage = 1/nrow(PalmBeach) + devsquared/sum(devsquared)
#Save Leverage Into Data
PalmBeach$Leverage= Leverage
#Print Data in Order of Leverage
sort(PalmBeach)
PalmBeach[order(PalmBeach$Leverage,decreasing=TRUE),]
#Calculate Average Number of Votes for Bush
avg.x = mean(PalmBeach$Bush)
devsquared= (PalmBeach$Bush - avg.x)^2
#Calculate Leverage
Leverage = 1/nrow(PalmBeach) + devsquared/sum(devsquared)
#Save Leverage Into Data
PalmBeach$Leverage= Leverage
#Print Data in Order of Leverage
head(PalmBeach[order(PalmBeach$Leverage,decreasing=TRUE),],5)
6/57
6/67
#Extract Standard Error of Regression
lm(Buchanan~Bush, data=PalmBeach)
vote.mod = lm(Buchanan~Bush, data=PalmBeach)
#Extract Standard Error of Regression
summary(vote.mod)$sigma
vote.mod$residuals/(sigma.regression*sqrt(1-Leverage))
vote.mod = lm(Buchanan~Bush, data=PalmBeach)
#Extract Standard Error of Regression
sigma.regression = summary(vote.mod)$sigma
#Calculate Standardized Residuals
vote.mod$residuals/(sigma.regression*sqrt(1-Leverage))
#Fit Model
vote.mod = lm(Buchanan~Bush, data=PalmBeach)
#Extract Standard Error of Regression
sigma.reg = summary(vote.mod)$sigma
#Calculate Standardized Residuals
std.res = vote.mod$residuals/(sigma.reg*sqrt(1-Leverage))
vote.mod$residuals/(sigma.reg*sqrt(1-Leverage))
#Save Actual Residuals
PalmBeach$Residual = vote.mod$residuals
View(PalmBeach)
#Fit Model
vote.mod = lm(Buchanan~Bush, data=PalmBeach)
#Extract Standard Error of Regression
sigma.reg = summary(vote.mod)$sigma
#Save Actual Residuals
PalmBeach$Residual = vote.mod$residuals
#Calculate and Save Standardized Residual
PalmBeach$StdRes = PalmBeach$Residual/(sigma.reg*sqrt(1-PalmBeach$Leverage))
View(PalmBeach)
#Calculate Cook's Distance
cooks.distance(vote.mod)
vote.mod = lm(Buchanan~Bush, data=PalmBeach)
#Extract Standard Error of Regression
sigma.reg = summary(vote.mod)$sigma
#Save Actual Residuals
PalmBeach$Residual = vote.mod$residuals
#Calculate and Save Standardized Residual
PalmBeach$StdRes = PalmBeach$Residual/(sigma.reg*sqrt(1-PalmBeach$Leverage))
#Calculate and Save Cook's Distance
PalmBeach$CookD=cooks.distance(vote.mod)
#Sort By Cook's Distance Output Data
PalmBeach[order(PalmBeach$CookD,decreasing=T),]
#Find Very Unusual Cook's Distance
PalmBeach[which(PalmBeach$CookD>1),]
PalmBeach[which(PalmBeach$County!=DADE),]
noDade = PalmBeach[which(PalmBeach$County!="DADE"),]
vote.mod.noDade = lm(Buchanan~Bush, data=noDade)
vote.mod = lm(Buchanan~Bush, data=PalmBeach)
noDade = PalmBeach[which(PalmBeach$County!="DADE"),]
vote.mod.noDade = lm(Buchanan~Bush, data=noDade)
noPB = PalmBeach[which(PalmBeach$County!="PALM BEACH"),]
vote.mod.noPB = lm(Buchanan~Bush, data=noPB)
plot(Buchanan~Bush,data=PalmBeach)
abline(ElectionModel, col="blue")
vote.mod = lm(Buchanan~Bush, data=PalmBeach)
noDade = PalmBeach[which(PalmBeach$County!="DADE"),]
vote.mod.noDade = lm(Buchanan~Bush, data=noDade)
noPB = PalmBeach[which(PalmBeach$County!="PALM BEACH"),]
vote.mod.noPB = lm(Buchanan~Bush, data=noPB)
plot(Buchanan~Bush,data=PalmBeach)
abline(vote.mod, col="blue")
abline(vote.mod.noDade, col="green")
abline(vote.mod.noPB, col="red")
abline(vote.mod.noPB, col="red",lwd=2)
vote.mod = lm(Buchanan~Bush, data=PalmBeach)
noDade = PalmBeach[which(PalmBeach$County!="DADE"),]
vote.mod.noDade = lm(Buchanan~Bush, data=noDade)
noPB = PalmBeach[which(PalmBeach$County!="PALM BEACH"),]
vote.mod.noPB = lm(Buchanan~Bush, data=noPB)
plot(Buchanan~Bush,data=PalmBeach)
abline(vote.mod, col="blue",lwd=2)
abline(vote.mod.noDade, col="green",lwd=2)
abline(vote.mod.noPB, col="red",lwd=2)
vote.mod = lm(Buchanan~Bush, data=PalmBeach)
noDade = PalmBeach[which(PalmBeach$County!="DADE"),]
vote.mod.noDade = lm(Buchanan~Bush, data=noDade)
noPB = PalmBeach[which(PalmBeach$County!="PALM BEACH"),]
vote.mod.noPB = lm(Buchanan~Bush, data=noPB)
plot(Buchanan~Bush,data=PalmBeach)
abline(vote.mod, col="blue",lwd=2)
abline(vote.mod.noDade, col="green",lwd=2,lty=3)
abline(vote.mod.noPB, col="red",lwd=2,lty=5)
knitr::opts_chunk$set(echo = TRUE)
library(Stat2Data)
data("Perch")
Perch
mod.interact = lm(Weight ~ Length * Width, data=Perch)
summary(mod.interact)
mod.interact = lm(Weight ~ Length * Width, data=Perch)
summary(mod.interact)
plot(mod.interact)
mod.interact = lm(Weight ~ Length * Width, data=Perch)
summary(mod.interact)
plot(mod.interact,which=c(1,2))
mod.interact = lm(Weight ~ Length * Width, data=Perch)
summary(mod.interact)
plot(mod.interact,which=c(1,2))
mod.interact = lm(Weight ~ Length * Width, data=Perch)
summary(mod.interact)
plot(mod.interact,which=c(1,2))
mod.interact = lm(Weight ~ Length * Width, data=Perch)
summary(mod.interact)
plot(mod.interact,which=c(1,2))
mod.interact = lm(Weight ~ Length * Width, data=Perch)
summary(mod.interact)
plot(mod.interact,which=c(1,2))
mod.interact = lm(Weight ~ Length * Width, data=Perch)
summary(mod.interact)
plot(mod.interact,which=c(1,2))
data("CO2Germany")
data("CO2Germany")
head(CO2Germany)
library(mosaic)
plot(CO2~Day, data = CO2Germany)
poly2 = lm(CO2~Day + Day^2,data=CO2Germany)
poly2 = lm(CO2~Day + Day^2,data=CO2Germany)
summary(poly2)
poly2 = lm(CO2~Day + I(Day^2),data=CO2Germany)
summary(poly2)
poly2 = lm(CO2~poly(Day,degree=2),data=CO2Germany)
summary(poly2)
library(mosaic)
plot(CO2~Day, data = CO2Germany)
poly2 = lm(CO2~Day + I(Day*Day),data=CO2Germany)
summary(poly2)
poly2 = lm(CO2~poly(Day,2,raw=TRUE),data=CO2Germany)
summary(poly2)
poly2 = lm(CO2~Day + I(Day^2),data=CO2Germany)
summary(poly2)
coef(poly2)
plot(CO2~Day, data = CO2Germany)
curve(y=)
coef(poly2)[1]
plot(CO2~Day, data = CO2Germany)
curve(coef(poly2)[1]+coef(poly2)[2]*x+coef(poly2)[3]*x^2,add=TRUE)
plot(CO2~Day, data = CO2Germany)
curve(coef(poly2)[1]+coef(poly2)[2]*x+coef(poly2)[3]*x^2,add=TRUE,col="blue")
plot(CO2~Day, data = CO2Germany)
curve(coef(poly2)[1]+coef(poly2)[2]*x+coef(poly2)[3]*x^2,
add=TRUE,col="blue",cex=2)
plot(CO2~Day, data = CO2Germany)
curve(coef(poly2)[1]+coef(poly2)[2]*x+coef(poly2)[3]*x^2,
add=TRUE,col="blue",lwd=2)
plot(CO2~Day, data = CO2Germany)
curve(coef(poly2)[1]+coef(poly2)[2]*x+coef(poly2)[3]*x^2,
add=TRUE,col="blue",lwd=2,lty=2)
#This code chunk is for modifying the global options and for loading required R packages
knitr::opts_chunk$set(echo = TRUE)
options(scipen=999) #Prevents the use of scientific notation
library(leaps)
library(Stat2Data)
data("NCbirths")
View(NCbirths)
#This code chunk is for modifying the global options and for loading required R packages
knitr::opts_chunk$set(echo = TRUE)
options(scipen=999) #Prevents the use of scientific notation
library(leaps)
library(Stat2Data)
data("NCbirths")
str(NCB)
#This code chunk is for modifying the global options and for loading required R packages
knitr::opts_chunk$set(echo = TRUE)
options(scipen=999) #Prevents the use of scientific notation
library(leaps)
library(Stat2Data)
data("NCbirths")
NCB = NCbirths
str(NCB)
